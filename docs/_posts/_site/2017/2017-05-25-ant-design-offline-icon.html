<p>最近在使用React实现公司一套系统的前端。控件库，看中了蚂蚁金服的<a href="https://ant.design">Ant Design</a>。</p>

<p>脚手架使用的是React官方的<a href="https://github.com/facebookincubator/create-react-app">create-react-app</a>，创建完成后，引入了Ant Design。在我自己的笔记本调试的都很好，但放到公司的开发机器上，发现图标资源都无法加载。马上看了一下浏览器的资源请求情况，果然，Ant Design默认使用的是阿里的CDN。</p>

<p>公司是内网环境，显然是行不通的。官方文档果然给出了<a href="https://ant.design/components/icon-cn/#本地部署">本地部署的提示</a>。</p>

<p>研究了一番，发现主要是要覆盖<code class="highlighter-rouge">@icon-url</code>这个less变量，所以就要开启less支持。幸好官方在<a href="https://ant.design/docs/react/use-with-create-react-app-cn#自定义主题">自定义主题</a>一节，已经给出了create-react-app中如何实现主题less变量的覆盖；同理，在modifyVar节点增加<code class="highlighter-rouge">@icon-url</code>的覆盖，如下：</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> modifyVars: { 
          // 修改整体主题颜色
          // "@primary-color": "#1DA57A",  
          // 修改图标库为本地离线，而不是阿里云CDN上的图标资源 
          "@icon-url": '"/iconfont/iconfont"' },
</code></pre></div></div>
<p>然后在<code class="highlighter-rouge">/public</code>目录增加<code class="highlighter-rouge">iconfront</code>目录，并将下载好的<a href="https://ant.design/docs/resource/download">Web Font文件</a>放到这个目录即可。
不过还是有几个细节要注意：</p>

<ol>
  <li>要同时修改<code class="highlighter-rouge">webpack.config.dev.js</code>和<code class="highlighter-rouge">webpack.config.prd.js</code>，保证测试环境和生产环境都生效。</li>
  <li><code class="highlighter-rouge">iconfront</code>文件夹要放在<code class="highlighter-rouge">/public</code>目录，而不是<code class="highlighter-rouge">/src</code>目录。虽然调试环境两者都能生效，但生产环境后者是不生效的。</li>
  <li><code class="highlighter-rouge">@icon-url</code>的值里面有双引号。</li>
</ol>
